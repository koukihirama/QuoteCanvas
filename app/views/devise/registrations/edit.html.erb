<!-- 背景 -->
<div class="fixed inset-0 -z-10 gh-sky">
  <div class="absolute inset-0 gh-hills opacity-70"></div>
  <div class="absolute inset-0 gh-grain pointer-events-none"></div>
</div>

<div class="container mx-auto max-w-3xl px-4 md:px-8 py-8 md:py-12">
  <div class="mb-6">
    <%= link_to "← 戻る", (defined?(profile_path) ? profile_path : root_path), class: "link link-primary" %>
  </div>

  <div class="rounded-3xl gh-glass p-6 md:p-8 relative overflow-hidden">
    <div class="pointer-events-none absolute -top-24 -right-24 size-80 rounded-full
                bg-gradient-to-tr from-amber-200/40 to-rose-200/40 blur-3xl"></div>

    <h1 class="text-2xl md:text-3xl font-extrabold gh-underline mb-6">プロフィール編集</h1>

    <%= form_for(resource, as: resource_name, url: registration_path(resource_name),
                 html: { method: :put, class: "space-y-6" }) do |f| %>

      <% if resource.errors.any? %>
        <div class="alert alert-error">
          <span>入力にエラーがあるよ（<%= resource.errors.count %>件）</span>
          <ul class="list-disc pl-5">
            <% resource.errors.full_messages.each do |m| %>
              <li><%= m %></li>
            <% end %>
          </ul>
        </div>
      <% end %>

      <!-- 名前 -->
      <div>
        <%= f.label :name, "名前", class: "block font-semibold mb-1" %>
        <%= f.text_field :name, class: "input input-bordered w-full" %>
      </div>

      <!-- メール -->
      <div>
        <%= f.label :email, "メールアドレス", class: "block font-semibold mb-1" %>
        <%= f.email_field :email, autofocus: true, class: "input input-bordered w-full" %>
      </div>

      <!-- Devise仕様: 確認用の現在パスワード -->
      <div>
        <%= f.label :current_password, "現在のパスワード（確認用）", class: "block font-semibold mb-1" %>
        <%= f.password_field :current_password, autocomplete: "current-password",
                             class: "input input-bordered w-full" %>
        <p class="text-sm opacity-70 mt-1">プロフィールを更新するには現在のパスワードが必要です。</p>
      </div>

      <div class="flex gap-2">
        <%= f.submit "更新する", class: "btn btn-primary" %>
        <%= link_to "キャンセル", (defined?(profile_path) ? profile_path : root_path), class: "btn btn-ghost" %>
      </div>
    <% end %>
  </div>
</div>