<!-- 背景 -->
<div class="fixed inset-0 -z-10 gh-sky">
  <div class="absolute inset-0 gh-hills opacity-70"></div>
  <div class="absolute inset-0 gh-grain pointer-events-none"></div>
</div>

<div class="container mx-auto max-w-5xl px-4 md:px-8 py-8 md:py-12">
  <!-- ヘッダーバー -->
  <div class="flex items-center justify-between mb-6">
    <%= link_to "← 戻る", passage_path(@passage), class: "link link-primary" %>
    <div class="text-sm opacity-70">カスタマイズを編集</div>
  </div>

  <div class="rounded-3xl gh-glass p-6 md:p-8 relative overflow-hidden">
    <div class="pointer-events-none absolute -top-24 -right-24 size-80 rounded-full bg-gradient-to-tr from-amber-200/40 to-rose-200/40 blur-3xl"></div>
    <h1 class="text-2xl md:text-3xl font-extrabold gh-underline mb-6">カスタマイズを編集</h1>

    <% fallback = {
      bg:   @customization.bg_color.presence || @passage.customization&.bg_color.presence || @passage.bg_color.presence || "#F9FAFB",
      text: @customization.color.presence    || @passage.customization&.color.presence    || @passage.text_color.presence || "#111827",
      font: @customization.font.presence     || @passage.customization&.font.presence     || @passage.font_family.presence || "var(--font-serif)"
    } %>

    <%= render "form",
          customization: @customization,
          passage: @passage,
          url:     passage_customization_path(@passage), # PATCH/PUT
          submit_label: "更新する",
          fallback: fallback %>
  </div>
</div>