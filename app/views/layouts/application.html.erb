<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <title><%= content_for(:title) || "QuoteCanvas" %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark">
    <meta name="theme-color" content="#F9FAFB">

    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <%= yield :head %>

    <link rel="manifest" href="/manifest.json">

    <%# フォント最適化：Interはローカル（inter-font.css）、GoogleはShipporiのみ %>
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Shippori+Mincho:wght@600;700&display=swap" rel="stylesheet">

    <%= stylesheet_link_tag "tailwind", "inter-font", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>

    <%= javascript_include_tag "application", "data-turbo-track": "reload", type: "module" %>

    <style>
      /* Turbo プログレスバーを少し見やすく */
      .turbo-progress-bar{ height:3px; background:linear-gradient(90deg,#22d3ee,#f472b6); }
    </style>
  </head>

  <body class="min-h-dvh flex flex-col bg-base-200">
    <!-- キーボード操作向け：コンテンツへスキップ -->
    <a href="#main" class="sr-only focus:not-sr-only focus:fixed focus:top-2 focus:left-2
                         focus:bg-base-100 focus:text-base-content focus:px-3 focus:py-2 focus:rounded">
      コンテンツへスキップ
    </a>

    <%= render "shared/header" %>
    <%= render "shared/welcome_banner" %>

    <main id="main"
          class="container mx-auto w-full max-w-7xl flex-1 px-4 md:px-8 pt-16 md:pt-20 pb-10
                 min-h-[calc(100dvh-4rem-4rem)] md:min-h-[calc(100dvh-5rem-4rem)]
                 [padding-bottom:env(safe-area-inset-bottom)]">
      <%= render "shared/flash" %>
      <%= yield %>
    </main>

    <%= render "shared/footer" %>
    <% if user_signed_in? && current_user.show_guide? %>
      <%= render "shared/onboarding_modal" %>
    <% end %>
  </body>
</html>