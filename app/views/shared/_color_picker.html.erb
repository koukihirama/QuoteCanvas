<div
  data-controller="color-picker"
  data-color-picker-key-value="<%= picker_key %>"><!-- 例: "text" / "bg" -->

  <%= f.label field, label, class: "block font-semibold mb-1" %>

  <!-- プリセット -->
  <div class="flex flex-wrap gap-2 mb-2">
    <% [
      "#111827", "#374151", "#6B7280", "#9CA3AF", "#F9FAFB",
      "#000000", "#FFFFFF", "#EF4444", "#F59E0B", "#10B981",
      "#3B82F6", "#8B5CF6", "#EC4899"
    ].each do |hex| %>
      <button type="button"
              class="size-6 rounded-full border"
              style="background:<%= hex %>"
              title="<%= hex %>"
              data-action="click->color-picker#pick"
              data-color-picker-color-param="<%= hex %>"></button>
    <% end %>
  </div>

  <div class="flex items-center gap-2">
    <%= f.text_field field,
          class: "input input-bordered w-full",
          placeholder: default_color,
          value: (f.object.public_send(field) || default_color),
          data: { action: "input->color-picker#manual change->color-picker#manual",
                  color_picker_target: "field" } %>

    <input type="color"
           class="input w-12 p-0"
           value="<%= (f.object.public_send(field) || default_color) %>"
           data-action="input->color-picker#choose change->color-picker#choose"
           data-color-picker-target="native" />

    <span class="badge" data-color-picker-target="badge">
      <%= (f.object.public_send(field) || default_color).upcase %>
    </span>
  </div>

  <!-- 最近使った色（JSで差し込む） -->
  <div class="mt-2 flex flex-wrap gap-2" data-color-picker-target="recent"></div>
</div>